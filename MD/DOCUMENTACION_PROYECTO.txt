================================================================================
DOCUMENTACIÃ“N TÃ‰CNICA DEL PROYECTO - GEARSTEED
REFERENCIA PARA ASISTENTE IA - QUÃ‰ HACE CADA ARCHIVO Y CÃ“MO USARLO
================================================================================

FECHA DE ÃšLTIMA ACTUALIZACIÃ“N: 12 de Noviembre, 2025

âš ï¸ ESTE DOCUMENTO ES PARA REFERENCIA DEL ASISTENTE IA âš ï¸
Contiene informaciÃ³n tÃ©cnica detallada sobre quÃ© hace cada archivo,
quÃ© funciones contiene, cÃ³mo estÃ¡n conectados y quÃ© NO se debe modificar.

================================================================================
ÃNDICE RÃPIDO
================================================================================
1. Resumen del Proyecto (QUÃ‰ ES)
2. Mapa de Archivos (QUÃ‰ HACE CADA UNO)
3. auth.js - Funciones y Uso
4. PÃ¡ginas HTML - Dependencias y Modificaciones
5. Reglas CrÃ­ticas (NO TOCAR)
6. Problemas Conocidos y Soluciones
7. CÃ³mo Agregar Nuevas Funcionalidades
8. Debugging y Troubleshooting

================================================================================
1. RESUMEN DEL PROYECTO (QUÃ‰ ES)
================================================================================

GEARSTEED = Concesionaria de autos + Venta de refacciones online

REGLA DE ORO:
âŒ VEHÃCULOS = SOLO VER (no se pueden comprar, solo cotizar)
âœ… REFACCIONES = SE PUEDEN COMPRAR (agregar al carrito y pagar)

Usuario puede:
- Navegar por vehÃ­culos (ver stock, cotizar)
- COMPRAR refacciones (historia.html)
- Registrarse / Login
- Agregar refacciones al carrito
- Aplicar cupones
- Ver resumen y proceder al pago (requiere login)

================================================================================
2. MAPA DE ARCHIVOS (QUÃ‰ HACE CADA UNO Y CUÃNDO MODIFICARLO)
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ARCHIVOS CORE (TOCAR CON CUIDADO)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“„ auth.js (503 lÃ­neas)
   QUÃ‰ HACE:
   - GestiÃ³n de login/registro/logout
   - TODAS las funciones del carrito de compras
   - Almacenamiento en localStorage
   - Validaciones de usuario
   - Notificaciones y UI del carrito
   
   FUNCIONES PRINCIPALES:
   â€¢ register(email, password, firstName, lastName)
   â€¢ login(email, password, rememberMe) 
   â€¢ logout()
   â€¢ isAuthenticated()
   â€¢ getCurrentUser()
   â€¢ addToCart(product) â† NORMALIZA datos espaÃ±olâ†’inglÃ©s
   â€¢ getCart() â† Retorna array de productos
   â€¢ updateCartQuantity(indexOrId, cantidad) â† Acepta Ã­ndice O id
   â€¢ removeFromCart(indexOrId) â† Acepta Ã­ndice O id
   â€¢ clearCart()
   â€¢ getCartTotal() â† Compatible espaÃ±ol/inglÃ©s
   â€¢ getCartItemCount() â† Compatible espaÃ±ol/inglÃ©s
   â€¢ updateCartUI() â† Actualiza contador del header
   â€¢ showCartNotification(message)
   
   CUÃNDO MODIFICAR:
   - Si necesitas cambiar lÃ³gica del carrito
   - Si agregas nuevas validaciones de usuario
   - Si cambias formato de almacenamiento
   
   âš ï¸ NO MODIFICAR:
   - Estructura de normalizaciÃ³n de productos (lÃ­neas 214-246)
   - Compatibilidad espaÃ±ol/inglÃ©s en getCartTotal y getCartItemCount
   - Nombres de keys de localStorage: 'cart', 'gearsteed_user', etc.

ğŸ“„ styles.css
   QUÃ‰ HACE:
   - Estilos generales del sitio
   - Layout del header, footer, navegaciÃ³n
   - Estilos de botones base
   - Grid y flex layouts
   
   CUÃNDO MODIFICAR:
   - Cambios de diseÃ±o general
   - Colores de marca
   - TipografÃ­a base
   
   âš ï¸ CONFLICTO CONOCIDO:
   - Puede ocultar botones de "Agregar al Carrito" en historia.html
   - SoluciÃ³n: usar !important en estilos inline de historia.html

ğŸ“„ auth-styles.css
   QUÃ‰ HACE:
   - Estilos SOLO para sistema de autenticaciÃ³n
   - Estilos del icono de carrito y contador
   - Estilos del menÃº de usuario
   - Modal de notificaciones del carrito
   
   CUÃNDO MODIFICAR:
   - Cambiar diseÃ±o del carrito en header
   - Modificar notificaciones
   - Ajustar menÃº de usuario
   
   âš ï¸ NO TOCAR:
   - Clases .cart-icon, .cart-count (usadas en todas las pÃ¡ginas)
   - Clases .user-icon, .user-menu (menÃº de usuario)

ğŸ“„ script.js
   QUÃ‰ HACE:
   - Scripts generales del sitio
   - Animaciones
   - Interacciones base
   
   âš ï¸ PROBLEMA CONOCIDO:
   - Puede sobrescribir contenido de historia.html
   - SoluciÃ³n: MutationObserver en historia.html protege el catÃ¡logo
   
   CUÃNDO MODIFICAR:
   - Agregar animaciones generales
   - Funcionalidades que afectan todo el sitio
   
   âš ï¸ CUIDADO:
   - NO hacer manipulaciÃ³n DOM en historia.html desde aquÃ­
   - Verificar que no entre en conflicto con auth.js

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PÃGINAS HTML - ESTRUCTURA Y DEPENDENCIAS                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“„ index.html
   QUÃ‰ HACE: PÃ¡gina de inicio
   SCRIPTS: script.js, auth.js (defer)
   ESTILOS: styles.css, auth-styles.css
   HEADER: âœ… Con carrito y usuario
   MODIFICAR: Contenido de bienvenida, banners, secciones principales

ğŸ“„ vehiculos.html  
   QUÃ‰ HACE: Muestra catÃ¡logo de VEHÃCULOS (NO COMPRABLES)
   SCRIPTS: script.js, auth.js (defer)
   ESTILOS: styles.css, auth-styles.css
   HEADER: âœ… Con carrito y usuario
   
   IMPORTANTE:
   âŒ NO agregar botones de "Agregar al Carrito"
   âœ… Solo mostrar: imagen, nombre, precio, stock, "Ver Detalles y Cotizar"
   
   BADGES DE STOCK:
   - "Disponible en Stock" (verde)
   - "Pocas Unidades" (amarillo)
   
   MODIFICAR: Para agregar/quitar vehÃ­culos, cambiar precios, actualizar stock

ğŸ“„ historia.html â­ IMPORTANTE
   QUÃ‰ HACE: CatÃ¡logo de REFACCIONES (PRODUCTOS COMPRABLES)
   SCRIPTS: script.js, auth.js (defer)
   ESTILOS: styles.css, auth-styles.css
   HEADER: âœ… Con carrito y usuario
   
   PRODUCTOS ACTUALES (9):
   1. Amortiguador Monroe - $1,299.99 - AM-001
   2. Bomba de Combustible - $2,499.99 - BC-002
   3. Filtro de Aceite Premium - $189.99 - FO-003
   4. Kit de Clutch LuK - $3,899.99 - KC-004
   5. Pastillas de Freno Brembo - $899.99 - PF-005
   6. BujÃ­as de Iridio - $699.99 - BI-006
   7. Discos de Freno Ventilados - $1,599.99 - DF-007
   8. BaterÃ­a 12V 60Ah - $1,899.99 - BT-008
   9. Radiador de Aluminio - $2,199.99 - RA-009
   
   ESTRUCTURA DE CADA PRODUCTO:
   ```html
   <div class="product-card">
       <img src="img/placeholder.jpg" alt="Nombre">
       <h3>Nombre del Producto</h3>
       <p class="price">$X,XXX.XX</p>
       <p class="sku">SKU: XX-XXX</p>
       <button onclick="addRefaccionToCart('Nombre', XXXX.XX, 'SKU-XXX')" 
               style="background: linear-gradient(135deg, #ff6b35 0%, #ff8c61 100%) !important; 
                      display: block !important; 
                      visibility: visible !important;">
           <i class="fas fa-shopping-cart"></i> Agregar al Carrito
       </button>
   </div>
   ```
   
   FUNCIÃ“N EN HISTORIA.HTML (lÃ­nea 752):
   ```javascript
   function addRefaccionToCart(name, price, sku) {
       addToCart({  // â† Llama a funciÃ³n de auth.js
           id: sku,
           name: name,
           price: price,
           sku: sku,
           image: 'img/placeholder.jpg',
           quantity: 1
       });
       // Feedback visual del botÃ³n (cambia a verde con check)
   }
   ```
   
   âš ï¸ PROTECCIÃ“N DOM (lÃ­nea ~780):
   MutationObserver evita que script.js sobrescriba el catÃ¡logo
   ```javascript
   const observer = new MutationObserver(function(mutations) {
       // Si script.js modifica el DOM, lo restauramos
   });
   ```
   
   MODIFICAR CUANDO:
   - Agregar nuevos productos
   - Cambiar precios
   - Actualizar imÃ¡genes
   - Modificar SKUs
   
   âš ï¸ AL AGREGAR PRODUCTO:
   1. Mantener !important en estilos del botÃ³n
   2. Usar onclick="addRefaccionToCart('Nombre', Precio, 'SKU')"
   3. NO usar comillas dobles dentro del onclick
   4. Precio sin sÃ­mbolo $ ni comas (usar punto decimal)
   
   âš ï¸ NO TOCAR:
   - MutationObserver (lÃ­neas 780+)
   - FunciÃ³n addRefaccionToCart
   - Estilos !important de los botones

ğŸ“„ carrito.html â­ IMPORTANTE
   QUÃ‰ HACE: PÃ¡gina del carrito de compras completo
   SCRIPTS: auth.js (SIN defer), luego script inline
   ESTILOS: styles.css, auth-styles.css
   HEADER: âœ… Con carrito y usuario
   
   âš ï¸ CRÃTICO: auth.js se carga SIN defer aquÃ­
   <script src="auth.js"></script>  â† Sin defer para carga sÃ­ncrona
   
   SECCIONES:
   1. Estado vacÃ­o (id="emptyCart") - Mostrar si cart.length === 0
   2. Contenido del carrito (id="cartContent") - Grid de productos
   3. Resumen (subtotal, envÃ­o, IVA, total)
   4. Sistema de cupones
   5. Botones: Vaciar Carrito, Aplicar CupÃ³n, Proceder al Pago
   
   FUNCIONES PRINCIPALES (en script inline):
   
   â€¢ migrateOldCartData() [lÃ­nea ~672]
     - Convierte datos viejos espaÃ±olâ†’inglÃ©s
     - Se ejecuta ANTES de renderizar
     - NO TOCAR, crÃ­tica para compatibilidad
   
   â€¢ initCartPage() [lÃ­nea ~720]
     - Inicializa la pÃ¡gina
     - Verifica que getCart estÃ© disponible
     - Llama renderCartPage() y setupEventListeners()
   
   â€¢ renderCartPage() [lÃ­nea ~735]
     - Obtiene cart con getCart()
     - Decide mostrar empty o content
     - Llama renderCartItems() y updateCartSummary()
   
   â€¢ renderCartItems(cart) [lÃ­nea ~750]
     - Genera HTML de cada producto
     - Botones de cantidad (+/-, input)
     - BotÃ³n de eliminar producto
   
   â€¢ updateCartSummary(cart) [lÃ­nea ~820]
     - Calcula subtotal (suma de price * quantity)
     - EnvÃ­o: $200.00 fijo
     - IVA: 16% del subtotal
     - Aplica descuento si hay cupÃ³n
     - Actualiza DOM con totales
   
   â€¢ setupEventListeners() [lÃ­nea ~840]
     - Vaciar Carrito (clearCartBtn)
     - Aplicar CupÃ³n (applyCouponBtn)
     - Proceder al Pago (checkoutBtn) - requiere login
   
   â€¢ decreaseQuantity(index), increaseQuantity(index) [lÃ­nea ~880]
     - Usa updateCartQuantity(index, newQty) de auth.js
     - Rango: 1-99
   
   â€¢ removeItem(index) [lÃ­nea ~920]
     - ConfirmaciÃ³n con confirm()
     - Usa removeFromCart(index) de auth.js
   
   â€¢ applyCoupon() [lÃ­nea ~940]
     - Valida cÃ³digo ingresado
     - Cupones: DESCUENTO10 (10%), DESCUENTO20 (20%), GEARSTEED (15%)
     - Actualiza appliedCoupon variable
     - Re-calcula totales
   
   CUPONES VÃLIDOS:
   {
       'DESCUENTO10': { percentage: 10, description: '10% de descuento' },
       'DESCUENTO20': { percentage: 20, description: '20% de descuento' },
       'GEARSTEED': { percentage: 15, description: '15% de descuento especial' }
   }
   
   IDs DE ELEMENTOS CRÃTICOS:
   - emptyCart: div del estado vacÃ­o
   - cartContent: div del contenido
   - cartItemsContainer: donde se insertan productos
   - clearCartBtn: botÃ³n vaciar carrito
   - applyCouponBtn: botÃ³n aplicar cupÃ³n
   - checkoutBtn: botÃ³n proceder al pago
   - couponInput: input del cÃ³digo de cupÃ³n
   - couponMessage: mensaje de validaciÃ³n cupÃ³n
   - subtotalAmount, shippingAmount, taxAmount, totalAmount: spans de montos
   
   MODIFICAR CUANDO:
   - Cambiar cupones disponibles
   - Modificar cÃ¡lculo de envÃ­o
   - Cambiar tasa de IVA
   - Ajustar diseÃ±o del carrito
   
   âš ï¸ NO TOCAR:
   - Orden de carga de scripts
   - FunciÃ³n migrateOldCartData
   - Llamadas a funciones de auth.js
   - Validaciones de existencia de funciones

ğŸ“„ login.html
   QUÃ‰ HACE: PÃ¡gina de inicio de sesiÃ³n
   SCRIPTS: auth.js (defer)
   ESTILOS: auth-styles.css
   HEADER: âŒ No tiene (pÃ¡gina standalone)
   
   FORMULARIO:
   - Email (validaciÃ³n de formato)
   - Password
   - Checkbox "Recordarme" (usa sessionStorage vs localStorage)
   - Link a recuperaciÃ³n de contraseÃ±a
   - Link a registro
   
   FUNCIÃ“N AL SUBMIT:
   Llama login(email, password, rememberMe) de auth.js
   
   REDIRECT:
   Acepta parÃ¡metro ?redirect=pagina.html para redirigir despuÃ©s del login
   Ejemplo: login.html?redirect=carrito.html
   
   MODIFICAR CUANDO:
   - Cambiar diseÃ±o del formulario
   - Agregar campos adicionales
   - Modificar validaciones visuales

ğŸ“„ registro.html
   QUÃ‰ HACE: PÃ¡gina de registro de nuevos usuarios
   SCRIPTS: auth.js (defer)
   ESTILOS: auth-styles.css
   HEADER: âŒ No tiene (pÃ¡gina standalone)
   
   FORMULARIO:
   - Nombre
   - Apellido
   - Email
   - ContraseÃ±a (con indicador de fortaleza)
   - Confirmar contraseÃ±a
   - Link a login
   
   INDICADOR DE FORTALEZA:
   - DÃ©bil (rojo): < 6 caracteres
   - Media (amarillo): 6-8 caracteres
   - Fuerte (verde): > 8 caracteres + mayÃºsculas/nÃºmeros
   
   FUNCIÃ“N AL SUBMIT:
   Llama register(email, password, firstName, lastName) de auth.js
   
   VALIDACIONES:
   - Email formato vÃ¡lido
   - ContraseÃ±as coincidentes
   - ContraseÃ±a mÃ­nimo 6 caracteres
   
   MODIFICAR CUANDO:
   - Cambiar requisitos de contraseÃ±a
   - Agregar tÃ©rminos y condiciones
   - Modificar diseÃ±o

ğŸ“„ nosotros.html, contactanos.html, ubicacion.html
   QUÃ‰ HACEN: PÃ¡ginas informativas
   SCRIPTS: script.js, auth.js (defer)
   ESTILOS: styles.css, auth-styles.css
   HEADER: âœ… Con carrito y usuario
   
   MODIFICAR: Contenido informativo sin afectar funcionalidad

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CARPETAS Y ASSETS                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ img/
   - placeholder.jpg â† Imagen por defecto de productos
   - Otras imÃ¡genes del sitio
   
   MODIFICAR: Agregar imÃ¡genes reales de productos aquÃ­
